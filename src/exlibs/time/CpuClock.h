// ======================================================================================
// File         : CpuClock.h
// Author       : Wu Jie 
// Last Change  : 03/03/2010 | 09:15:54 AM | Wednesday,March
// Description  : 
// ======================================================================================

// #################################################################################
#ifndef CPUCLOCK_H_1267578975
#define CPUCLOCK_H_1267578975
// #################################################################################

///////////////////////////////////////////////////////////////////////////////
// includes
///////////////////////////////////////////////////////////////////////////////

#include "TimeSpan.h"

// ######################### 
namespace ex { 
// ######################### 

///////////////////////////////////////////////////////////////////////////////
// defines
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// class CpuClock 
// 
// Purpose: 
// 
///////////////////////////////////////////////////////////////////////////////

class EX_LIBS_DLL CpuClock
{
    ///////////////////////////////////////////////////////////////////////////////
    // static 
    ///////////////////////////////////////////////////////////////////////////////

    static uint64 s_CpuFrequency;

    ///////////////////////////////////////////////////////////////////////////////
    // static member functions
    ///////////////////////////////////////////////////////////////////////////////

public:

    static result_t init ();
    static uint64 Frequency () { return s_CpuFrequency; }
    static uint32 GetCurrentMSecs ();

    ///////////////////////////////////////////////////////////////////////////////
    // public member functions
    ///////////////////////////////////////////////////////////////////////////////

public:

    CpuClock ();

    void start ();
    timespan_t Elapsed (); // count will count the time from start to now.
    timespan_t count (); // count-last will count the time from last-cout to now.
    timespan_t Stop ();

    ///////////////////////////////////////////////////////////////////////////////
    // protected member functions
    ///////////////////////////////////////////////////////////////////////////////

protected:

    timespan_t GetTimeSpan ( uint64 _deltaCycle );


    ///////////////////////////////////////////////////////////////////////////////
    // protected member data
    ///////////////////////////////////////////////////////////////////////////////

protected:

    uint64 m_StartCouter;
    uint64 m_StopCouter;
    uint64 m_LastCouter;

}; // end class CpuClock

///////////////////////////////////////////////////////////////////////////////
// typedef
///////////////////////////////////////////////////////////////////////////////

typedef CpuClock cpu_clock_t;

// ######################### 
} // end namespace ex 
// ######################### 



// #################################################################################
#endif // END CPUCLOCK_H_1267578975
// #################################################################################
